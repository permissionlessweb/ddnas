
# DAO-DNAS: DAO gated Decentralized NAS, via Jackal Pin
<!-- Author: Returniflost, Discover Decentralization DAO DATE: 25/03/25 -->

## Project Overview
This project involves creating UX for secure file uploads to storage providers on jackal, via an Jackal Pin API. The worker will verify a private key signature hash required in any request to use a registerd api key to  upload a file DAO. DAOs must first register to its storage items a json encoded with its desired bounded parameters for maximum file size usage & lifespan of signatures, while making use of upload keys. Shared DAO keys are registered to this worker only by DAO members, and custom parameters within DAOs desired bounds.

## High-Level Requirements
1. DAO-DAO UI widget
2. Cloudflare worker api proxy 
3. Basic step-y-step guide for configuration & deployment

## Technical Requirements

### Core Functionality
1. **Signature Verification**
   - Registering DNAS Keys: verify signature is valid DAO member of the DAO the api-key is being registered to.
   - Using DNAS Keys: 
      - verify required  signature was generated by DAO member
      - within lifespan & upload limit desired by DAO params & api-key owner.
      - never ever reveal or make api-key publicly accessable
   - Unregistering DNAS Keys: 
      - verify is key owner before removing from store
      <!-- - each time DAO has member use shared key, check for any keys from any no-longer members -->

2. **API Integration**
   - Register DAO API: accept a valid signature from DAO member containing API key for Jackal PIN.
   - Authorized File Upload Proxy: properly handle successful/unsuccessful file uploads via api key and method (first method is jackal pin).
   <!-- - Pass through appropriate headers and authentication -->
   <!-- - Handle file streaming efficiently. -->

3. **DAO DAO UI Integration**
   - enable/disable widget via storage-item set.
   - display keys registered by DAO members to select for when uploading file
   - handle registering api-keys
   - handle removing api-keys 
   - handle uploading files (using api-keys) 

### Security Measures
1. **Access Control**
   - Dao Member Restricted: provide a DAO address to verify signature is from DAO member when using or registering api-key.
   - Configure permissions based on address/key groups
   - Enforce expiration times on signatures
   - Prevent signature replay attacks

2. **Rate Limiting & Protection**
   - Enforce file size limitsset by api-key owners
   - Monitor and block suspicious patterns

3. **Environment Security**
   - Secure storage of private API credentials in Cloudflare
   - Ensure all private keys are protected

## Technical Architecture
 
### Expected WorkFlow
1. DAO proposed to enable DAO-NAS widget.
2. If accepted, a DAO member registeres an API key to use for their DAO
3. A DAO member goes to upload a file using the widget, viewing a list of all registered API keys to make use of.
4. A DAO member sends a request to upload a file to the DAO-NAS cloudflare worker.
5. If signature is valid & signer  is able to make use of key, Worker uses private API key to upload file
6. Response from protected API is validated and returned to client

## Implementation Plan

### Phase 1: Cloudflare Development
1. Set up Cloudflare Worker development environment
2. Implement Cosmos signature verification functions
3. Implement register/unregister of API keys via DAO members
4. Integrate private API key authentication
5. Implement jackal API proxy 
6. Unit test confirming signature verification & registering/unregistering API keys

### Phase 2: DAO Widget Development 
1. Implement as option in available widgets to add
2. Implment support for selecting specific DAO members API key registered

### Phase 3: Testing & Deployment
1. testnet/softlaunch deployment + iterations to stable version
   
## Success Criteria
1. Successfully verify signatures on all requests
2. Securely proxy file uploads to protected API to jackal API
3. Handle files up to appropriate size limits efficiently
4. General test coverage 
 
## Cost and Payment Milestones
A total cost of 300 ATOM, divided into 3 payment milestones, is being requested in return for implementing this project scope.

### 1st Checkpoint: Initial Deposit (100 ATOM)
- Deliverables:
  - Project kickoff and general technical specification design
- Timeline: 1 week
- Payment trigger: Upon Snails DAO approval of assignment of this project sprint.

### 2nd Checkpoint: Cloudflare Worker Functionality (100 ATOM)
- Deliverables:
  - Complete Cosmos signature verification implementation
  - Functional Cloudflare Worker with Jackal API integration
  - Functional DAO member register & unregister of available API keys
  - Basic testing suite and security validation
- Timeline: 1 week after 1st checkpoint
- Payment trigger: Successful demonstration of end-to-end file upload with signature verification to designated DAO member.

### 3rd Checkpoint: Soft Launch of Custom UI (100 ATOM)
- Deliverables:
  - Production deployment of Cloudflare Worker
  - Stable version of custom DAO Widget UI
  - Complete testing suite with security validation
  - Performance optimization and final adjustments
  - Comprehensive documentation and handover materials
- Timeline: 1 week after second checkpoint 
- Payment trigger: Successful soft launch with UI and production deployment

### Payment Terms
- Payments will be made in ATOM to the designated wallet address
- Each payment will be triggered upon successful completion and designated DAO member approval of the checkpoint deliverables
- Final payment includes a 30-day warranty period for bug fixes and minor adjustments